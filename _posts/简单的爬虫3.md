---
title: ç®€å•çš„pythonçˆ¬è™« (ä¸‰)
tag: python
thumbnail: https://pic.kylinn.cloud/uploads/big/e33dafe5e69bef97839c1bac1f9d45b6.jpg
date: 2021/4/29
---

## çˆ¬è™«æ¡†æ¶
ä¸Šæ–‡ç®€å•è¯´äº†ä¸€ä¸‹çˆ¬åˆ°ç½‘é¡µä¹‹åçš„å†…å®¹æå–ï¼Œä½†æ˜¯æ„Ÿè§‰ååˆ†éº»çƒ¦ã€‚[ä¸Šæ–‡é“¾æ¥](https://kylinn.cloud/2021/04/26/%E7%AE%80%E5%8D%95%E7%9A%84%E7%88%AC%E8%99%AB2)
æ‰€ä»¥å†æ­£å¼å¼€å§‹çˆ¬å–å›¾ç‰‡ä¹‹å‰ï¼Œæˆ‘å…ˆä»‹ç»ä¸€ä¸‹ **çˆ¬è™«æ¡†æ¶**ï¼Œè¿™é‡Œè¦è¯´çš„æ˜¯ **BeautifulSoup4**ã€‚

åˆ«çš„å…ˆä¸è¯´ï¼Œç›´æ¥çœ‹ç»“æœ:

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20200611202852780.png#pic_center)

å†çœ‹ä»£ç ï¼Œä½ å°±çŸ¥é“ç”¨æ¡†æ¶æœ‰å¤šæ–¹ä¾¿ï¼Œå…¶å®bs4å¯èƒ½ä¸è¯¥å«æ¡†æ¶ ğŸ‘€ ã€‚

```python
import requests as rq
import re
from bs4 import BeautifulSoup as bs
from bs4 import SoupStrainer as ss

url = 'http://wjw.ah.gov.cn/xwzx/gzdt/53195761.html'
html = rq.get(url)
html.encoding = 'utf-8'
status = html.status_code
content = html.text
print(status)

need = ss(class_='wzcon j-fontContent clearfix')
soup = bs(content, 'lxml', parse_only=need)
print(soup.get_text())

```
å¯¹çš„ï¼Œåªæœ‰ä¸‰å¥è¯ã€‚åº•å±‚å·²ç»å°è£…çš„å¾ˆå¥½äº†ï¼Œæˆ‘ä»¬ç›´æ¥è°ƒç”¨å°±è¡Œã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20200611203301225.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2t5bGluaG9sbWVz,size_16,color_FFFFFF,t_70#pic_center)

- å…ˆæ‰¾åˆ°ä¸­é—´é‚£æ®µæ­£æ–‡é‚£é‡Œï¼Œå‘ç° class æ˜¯ 'wzcon j-fontContent clearfix'ï¼Œæˆ‘ä»¬ä¹Ÿåªè¦è¿™ä¸€éƒ¨åˆ†çš„å†…å®¹ï¼Œæ‰€ä»¥ç”¨ **SoupStrainer** æå–æˆ‘ä»¬éœ€è¦çš„é‚£ä¸€æ®µã€‚æ³¨æ„å‚æ•°æ˜¯ `class_` æœ‰ä¸‹åˆ’çº¿
- å†™æ³•æ˜¯æŠŠä¸Šæ–‡çš„ need ä½œä¸º **BeautifulSoup** ä¸­ parse_only çš„å‚æ•°ã€‚éœ€è¦æ³¨æ„çš„æ˜¯'lxml'è¿™ä¸ªæ˜¯å¤„ç† html/xml çš„åº•å±‚ï¼Œé»˜è®¤å†™è¿™ä¸ªå°±è¡Œäº†ï¼Œå…¶ä»–çš„è§£æå™¨ä¸å†ä»‹ç»ã€‚
- soup å°±æ˜¯æˆ‘ä»¬æ‹¿æ¥ç”¨çš„ä¸œè¥¿ï¼Œè¯»è€…å¯ä»¥è‡ªå·±è¾“å‡ºæ¥çœ‹ä¸€ä¸‹ï¼Œsoupå†…å®¹æ˜¯ä»€ä¹ˆï¼Œè¿™é‡Œå°±ä¸è¾“å‡ºäº†ã€‚
- ç›´æ¥ get_text() å‡½æ•° å¯ä»¥è·å–åˆ° **æ–‡æœ¬** ã€‚

BeautifulSoup4 å®‰è£…
```python
pip3 install beautifulsoup4
```
lxml å®‰è£…

```python
pip3 install lxml
```
BeautifulSoupçŸ¥è¯†ç‚¹æ¯”è¾ƒå¤šï¼Œæˆ‘ä¸åšå¤šçš„ä»‹ç»ï¼Œæ„Ÿå…´è¶£å¯ä»¥è‡ªè¡Œç™¾åº¦ï¼Œæœ‰å®˜æ–¹ä¸­æ–‡ã€‚
## å›¾ç‰‡çˆ¬è™«
è¿™é‡Œæˆ‘ä»¬å¼€å§‹çˆ¬å–å›¾ç‰‡æ•™ç¨‹ï¼š
ä¸‹é¢è¿™ä¸ªæ˜¯æˆ‘ä»¬è¦çˆ¬å–çš„ç½‘ç«™ï¼Œä½†æ˜¯å‡ºäº**æŸäº›è€ƒè™‘**ï¼Œå°±æŠŠç½‘å€éƒ¨åˆ†æ‰“ç äº†ï¼Œç›¸å…³å­—æ®µéƒ½åˆ äº†ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20200611211718327.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2t5bGluaG9sbWVz,size_16,color_FFFFFF,t_70#pic_center)

## ç½‘é¡µåˆ†æ

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20200611211855112.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2t5bGluaG9sbWVz,size_16,color_FFFFFF,t_70#pic_center)

æ‰¾åˆ°æˆ‘ä»¬éœ€è¦çš„é‚£ä¸€éƒ¨åˆ†ï¼Œå‘ç°æ¯å¼ å›¾ç‰‡éƒ½æœ‰ä¸ªé“¾æ¥ï¼Œå°±æ˜¯é‚£äº›aæ ‡ç­¾ï¼Œç›´æ¥æ‰“å¼€å°±å¯ä»¥æŸ¥çœ‹åˆ°å›¾ç‰‡ï¼Œå°±æ˜¯ä¸‹é¢çš„æ ·å­äº†

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20200611212345295.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2t5bGluaG9sbWVz,size_16,color_FFFFFF,t_70#pic_center)

é‚£å°±å¾ˆç®€å•äº†ï¼Œæˆ‘ä»¬æ‰¾åˆ°æ‰€æœ‰çš„ aæ ‡ç­¾ ï¼ŒæŠŠé‡Œé¢çš„å†…å®¹ä¿å­˜ä¸‹æ¥å°±æ˜¯å›¾ç‰‡äº†ã€‚



![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20200611213900902.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2t5bGluaG9sbWVz,size_16,color_FFFFFF,t_70#pic_center)

## ä»£ç è§£é‡Š
å› ä¸ºå¤§ä½“ä¸Šéƒ½å·®ä¸å¤šï¼Œæˆ‘å°±åªè§£é‡Šæ–°çš„å†…å®¹ï¼š
```python
tag = soup.find_all('a')
```
è¿™å¥è¯æ˜¯ï¼Œæ‰¾åˆ°soupé‡Œå…¨éƒ¨çš„aæ ‡ç­¾ï¼Œè¿”å›å¯¹è±¡æ˜¯ä¸€ä¸ªlistï¼Œæ¯ä¸ªlistçš„æˆå‘˜æ˜¯ä¸€ä¸ªtagç±»å‹çš„å˜é‡ï¼Œtagå°±æ˜¯è¯´çš„ ç½‘é¡µé‡Œçš„æ ‡ç­¾å˜› ğŸ·ï¸ 

`tag`å¯¹è±¡å¯ä»¥å½“æˆå­—å…¸æ¥ç”¨
è¿™æ ·å°±å¯ä»¥æŸ¥çœ‹åˆ°`href`å±æ€§çš„å€¼ï¼Œä¹Ÿå°±æ˜¯å›¾ç‰‡çš„é“¾æ¥
```python
tag[0]['href']
# https://nmj.miaowugo.com/wp-content/uploads/2020/06/58290-1591888143.jpg?x-oss-process=image/resize,m_fill,h_1536,w_1024
```
é€šè¿‡`attrs` å¯ä»¥çŸ¥é“æœ‰å“ªäº› `key`
```python
print(tag[0].attrs)
# {'href': 'https://nmj.miaowugo.com/wp-content/uploads/2020/06/58290-1591888143.jpg?x-oss-process=image/resize,m_fill,h_1536,w_1024', 'rel': ['attachment', 'wp-att-58291']}
```
## å…¨éƒ¨ä»£ç 
```python
import requests as rq
import re
from bs4 import BeautifulSoup as bs
from bs4 import SoupStrainer as ss


def save_img(url, name):
# ä¿å­˜å›¾ç‰‡çš„å‡½æ•°ï¼Œå°±ä¸è§£é‡Šè¿™ä¸ªäº†
    h = rq.get(url)
    with open(name, 'wb+') as f:
        f.write(h.content)
    return


url = 'https://xxxxx'
# å…ˆå‰å†™çš„æ—¶å€™ï¼Œæˆ‘è¿˜è®°ç€è¯´è¦åˆ æ‰è¿™é‡Œï¼Œç»“æœå‘äº†å¥½ä¹…çªç„¶æƒ³åˆ°æ²¡æœ‰åˆ ã€‚
html = rq.get(url)
html.encoding = 'utf-8'
status = html.status_code
content = html.text
print(status)

need = ss(class_='nv-content-wrap entry-content')
soup = bs(content, 'lxml', parse_only=need)

tag = soup.find_all('a')
# æ‰¾åˆ°æ‰€æœ‰çš„aæ ‡ç­¾ï¼Œè¿”å›ä¸€ä¸ª tagç±»å‹çš„ list ç»™ tagå˜é‡
j = 0 # å½“åå­—ç”¨çš„å˜é‡
for i in tag:
    print(i['href'])
    save_img(str(i['href']), str(j)+'.jpg')
    j += 1
print('OK')

```
## åè®°
**BeautifulSoup**ç”¨ç€è¿˜æ˜¯è›®æ–¹ä¾¿çš„ï¼Œæˆ‘æ²¡æœ‰è¯¦ç»†çš„è®²è¿™ä¸ªåº“ï¼Œæœ‰éœ€è¦çš„è¯»è€…å¯ä»¥è‡ªè¡ŒæŸ¥é˜…ï¼Œæˆ‘ä¹Ÿæ˜¯åˆšåˆšæ‰çœ‹äº†å›æ¥ã€‚æœ‰å®˜æ–¹ä¸­æ–‡ï¼ŒNICEï¼

çˆ¬è™«çš„å†…å®¹å…¶å®æˆ‘éƒ½æ²¡æœ‰è®²å¾ˆå¤šï¼Œæ¯”å¦‚åçˆ¬æŠ€æœ¯ã€Headerã€ä»£ç†æ± ç­‰ï¼Œæˆ‘è§‰å¾—è¿™äº›è¯´èµ·æ¥æ¯”è¾ƒå¤šï¼Œç®€å•çˆ¬è™«ä¸åˆé€‚ï¼Œå°±ç‚¹åˆ°ä¸ºæ­¢å§ã€‚
